<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å–„æ²»ç¾ - æ•°å­—åŒ–æ‘åŠ¡ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 414px;
            margin: 0 auto;
            background: #fff;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* å¤´éƒ¨å¯¼èˆª */
        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 20px 16px 16px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .header .subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .back-btn {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: none;
        }

        /* è§’è‰²é€‰æ‹©é¡µé¢ */
        .screen {
            display: none;
            min-height: calc(100vh - 80px);
        }

        .screen.active {
            display: block;
        }

        .role-selection {
            padding: 40px 20px;
            text-align: center;
        }

        .role-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .role-subtitle {
            font-size: 16px;
            color: #666;
            margin-bottom: 40px;
        }

        .role-cards {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .role-card {
            background: white;
            border-radius: 16px;
            padding: 30px 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .role-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            border-color: #4CAF50;
        }

        .role-card .icon {
            font-size: 48px;
            margin-bottom: 16px;
            color: #4CAF50;
        }

        .role-card h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .role-card p {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        /* æ‘ä¸¤å§”å·¥ä½œå° */
        .dashboard {
            padding: 20px;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .action-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        }

        .action-card .icon {
            font-size: 32px;
            margin-bottom: 12px;
            color: #4CAF50;
        }

        .action-card h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
            color: #333;
        }

        .action-card p {
            font-size: 12px;
            color: #666;
        }

        /* ä»»åŠ¡ç»Ÿè®¡ */
        .stats-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        .stats-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #333;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        /* æ–‡ä»¶ä¸Šä¼ é¡µé¢ */
        .upload-section {
            padding: 20px;
        }

        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #4CAF50;
            background: #f8fff8;
        }

        .upload-area.dragover {
            border-color: #4CAF50;
            background: #f0fff0;
        }

        .upload-icon {
            font-size: 48px;
            color: #ddd;
            margin-bottom: 16px;
        }

        .upload-area:hover .upload-icon {
            color: #4CAF50;
        }

        .upload-text {
            font-size: 16px;
            color: #666;
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 14px;
            color: #999;
        }

        .upload-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .method-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .method-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        }

        /* è¡¨æ ¼æ¨¡æ¿åº“ */
        .template-library {
            padding: 20px;
        }

        .template-grid {
            display: grid;
            gap: 16px;
        }

        .template-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        }

        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .template-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .template-badge {
            background: #e8f5e8;
            color: #4CAF50;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        .template-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .template-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }

        /* ä»»åŠ¡çœ‹æ¿ */
        .task-board {
            padding: 20px;
        }

        .progress-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .progress-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .progress-text {
            font-size: 16px;
            font-weight: 600;
            color: #4CAF50;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .task-tabs {
            display: flex;
            background: #f8f8f8;
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: white;
            color: #4CAF50;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .villager-list {
            display: grid;
            gap: 12px;
        }

        .villager-item {
            background: white;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .villager-info h4 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .villager-info p {
            font-size: 14px;
            color: #666;
        }

        .villager-actions {
            display: flex;
            gap: 8px;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-call {
            background: #e3f2fd;
            color: #2196F3;
        }

        .btn-edit {
            background: #fff3e0;
            color: #ff9800;
        }

        .btn-remind {
            background: #fce4ec;
            color: #e91e63;
        }

        /* æ‘æ°‘å¡«æŠ¥é¡µé¢ */
        .form-section {
            padding: 20px;
        }

        .form-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        .form-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .form-input.prefilled {
            background: #f8fff8;
            border-color: #4CAF50;
        }

        .prefilled-label {
            font-size: 12px;
            color: #4CAF50;
            margin-top: 4px;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 14px 24px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 12px;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e8e8e8;
        }

        /* åº•éƒ¨å¯¼èˆª */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 414px;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            padding: 8px 0;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.1);
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-item.active {
            color: #4CAF50;
        }

        .nav-item .icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-item .label {
            font-size: 12px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 375px) {
            .container {
                max-width: 100%;
            }
            
            .role-selection {
                padding: 30px 16px;
            }
            
            .dashboard {
                padding: 16px;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
        }

        /* éšè—æ–‡ä»¶è¾“å…¥ */
        #fileInput {
            display: none;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4CAF50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* æˆåŠŸæç¤º */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            border: 1px solid #c3e6cb;
        }

        /* å›¾æ ‡å­—ä½“ */
        .icon {
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <div class="header">
            <button class="back-btn" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 id="headerTitle">å–„æ²»ç¾</h1>
            <div class="subtitle" id="headerSubtitle">æ•°å­—åŒ–æ‘åŠ¡ç®¡ç†ç³»ç»Ÿ</div>
        </div>

        <!-- è§’è‰²é€‰æ‹©é¡µé¢ -->
        <div id="roleSelection" class="screen active">
            <div class="role-selection">
                <h2 class="role-title">æ¬¢è¿ä½¿ç”¨å–„æ²»ç¾</h2>
                <p class="role-subtitle">è¯·é€‰æ‹©æ‚¨çš„èº«ä»½</p>
                
                <div class="role-cards">
                    <div class="role-card" onclick="selectRole('village-committee')">
                        <div class="icon">ğŸ‘¥</div>
                        <h3>æ‘ä¸¤å§”</h3>
                        <p>æ‘å¹²éƒ¨å·¥ä½œå°<br>ç®¡ç†ä»»åŠ¡ã€æ•°æ®é‡‡é›†ã€è¡¨æ ¼å¤„ç†</p>
                    </div>
                    
                    <div class="role-card" onclick="selectRole('villager')">
                        <div class="icon">ğŸ‘¤</div>
                        <h3>æ‘æ°‘</h3>
                        <p>ä¿¡æ¯å¡«æŠ¥<br>æŸ¥çœ‹é€šçŸ¥ã€å¡«å†™è¡¨æ ¼ã€æ›´æ–°ä¿¡æ¯</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ‘ä¸¤å§”å·¥ä½œå° -->
        <div id="committeeDashboard" class="screen">
            <div class="dashboard">
                <!-- å¿«æ·æ“ä½œ -->
                <div class="quick-actions">
                    <div class="action-card" onclick="showScreen('fileUpload')">
                        <div class="icon">ğŸ“„</div>
                        <h4>æ–°å»ºä»»åŠ¡</h4>
                        <p>ä¸Šä¼ è¡¨æ ¼æ–‡ä»¶</p>
                    </div>
                    
                    <div class="action-card" onclick="showScreen('templateLibrary')">
                        <div class="icon">ğŸ“š</div>
                        <h4>æ¨¡æ¿åº“</h4>
                        <p>ä½¿ç”¨å·²ä¿å­˜æ¨¡æ¿</p>
                    </div>
                    
                    <div class="action-card" onclick="showScreen('taskBoard')">
                        <div class="icon">ğŸ“Š</div>
                        <h4>ä»»åŠ¡çœ‹æ¿</h4>
                        <p>æŸ¥çœ‹é‡‡é›†è¿›åº¦</p>
                    </div>
                    
                    <div class="action-card" onclick="showScreen('dataManagement')">
                        <div class="icon">ğŸ—ƒï¸</div>
                        <h4>æ‘å¤§è¡¨</h4>
                        <p>æ•°æ®ç»´æŠ¤ç®¡ç†</p>
                    </div>
                </div>

                <!-- ä»»åŠ¡ç»Ÿè®¡ -->
                <div class="stats-section">
                    <h3 class="stats-title">ä»Šæ—¥æ¦‚è§ˆ</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number">3</div>
                            <div class="stat-label">è¿›è¡Œä¸­ä»»åŠ¡</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">127</div>
                            <div class="stat-label">å·²å®Œæˆå¡«æŠ¥</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">23</div>
                            <div class="stat-label">å¾…å¤„ç†</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ–‡ä»¶ä¸Šä¼ é¡µé¢ -->
        <div id="fileUpload" class="screen">
            <div class="upload-section">
                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">â˜ï¸</div>
                    <div class="upload-text">ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶</div>
                    <div class="upload-hint">æ”¯æŒ Excelã€Wordã€PDFã€å›¾ç‰‡æ ¼å¼</div>
                </div>
                
                <input type="file" id="fileInput" accept=".xlsx,.xls,.doc,.docx,.pdf,.jpg,.jpeg,.png" onchange="handleFileUpload(event)">
                
                <div class="upload-methods">
                    <div class="method-card" onclick="startOCR()">
                        <div class="icon">ğŸ“·</div>
                        <h4>æ‹ç…§è¯†åˆ«</h4>
                        <p>OCRæ™ºèƒ½è¯†åˆ«</p>
                    </div>
                    
                    <div class="method-card" onclick="showScreen('templateLibrary')">
                        <div class="icon">ğŸ“‹</div>
                        <h4>é€‰æ‹©æ¨¡æ¿</h4>
                        <p>ä»æ¨¡æ¿åº“é€‰æ‹©</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¡¨æ ¼æ¨¡æ¿åº“ -->
        <div id="templateLibrary" class="screen">
            <div class="template-library">
                <div class="template-grid">
                    <div class="template-card" onclick="useTemplate('lowIncome')">
                        <div class="template-header">
                            <div class="template-name">å­£åº¦ä½ä¿æˆ·ç»Ÿè®¡</div>
                            <div class="template-badge">å¸¸ç”¨</div>
                        </div>
                        <div class="template-info">æœ€åä½¿ç”¨ï¼š2024å¹´3æœˆ</div>
                        <div class="template-info">åŒ…å«å­—æ®µï¼šå§“åã€èº«ä»½è¯ã€å®¶åº­æ”¶å…¥ã€è”ç³»æ–¹å¼</div>
                        <div class="template-actions">
                            <button class="btn-small btn-primary">ä½¿ç”¨æ¨¡æ¿</button>
                            <button class="btn-small btn-secondary">ç¼–è¾‘</button>
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="useTemplate('population')">
                        <div class="template-header">
                            <div class="template-name">äººå£æ™®æŸ¥ç™»è®°</div>
                            <div class="template-badge">æ–°å»º</div>
                        </div>
                        <div class="template-info">æœ€åä½¿ç”¨ï¼š2024å¹´2æœˆ</div>
                        <div class="template-info">åŒ…å«å­—æ®µï¼šæˆ·ä¸»å§“åã€å®¶åº­æˆå‘˜ã€å¹´é¾„ã€èŒä¸š</div>
                        <div class="template-actions">
                            <button class="btn-small btn-primary">ä½¿ç”¨æ¨¡æ¿</button>
                            <button class="btn-small btn-secondary">ç¼–è¾‘</button>
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="createNewTemplate()">
                        <div class="template-header">
                            <div class="template-name">+ åˆ›å»ºæ–°æ¨¡æ¿</div>
                        </div>
                        <div class="template-info">ä½¿ç”¨å¯è§†åŒ–å·¥å…·åˆ›å»ºè‡ªå®šä¹‰è¡¨æ ¼æ¨¡æ¿</div>
                        <div class="template-actions">
                            <button class="btn-small btn-primary">å¼€å§‹åˆ›å»º</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä»»åŠ¡çœ‹æ¿ -->
        <div id="taskBoard" class="screen">
            <div class="task-board">
                <!-- è¿›åº¦æ¦‚è§ˆ -->
                <div class="progress-card">
                    <div class="progress-header">
                        <div class="progress-title">å­£åº¦ä½ä¿æˆ·ç»Ÿè®¡</div>
                        <div class="progress-text">65/100 (65%)</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 65%"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 14px; color: #666;">
                        <span>å¼€å§‹æ—¶é—´ï¼š2024-03-01</span>
                        <span>æˆªæ­¢æ—¶é—´ï¼š2024-03-15</span>
                    </div>
                </div>

                <!-- ä»»åŠ¡æ ‡ç­¾é¡µ -->
                <div class="task-tabs">
                    <div class="tab active" onclick="switchTab('pending')">å¾…å®Œæˆ (35)</div>
                    <div class="tab" onclick="switchTab('completed')">å·²å®Œæˆ (65)</div>
                </div>

                <!-- æ‘æ°‘åˆ—è¡¨ -->
                <div id="pendingList" class="villager-list">
                    <div class="villager-item">
                        <div class="villager-info">
                            <h4>å¼ ä¸‰</h4>
                            <p>èº«ä»½è¯ï¼š320***********1234</p>
                        </div>
                        <div class="villager-actions">
                            <button class="btn-icon btn-call" onclick="callVillager('å¼ ä¸‰')" title="ç”µè¯è”ç³»">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="btn-icon btn-edit" onclick="fillForVillager('å¼ ä¸‰')" title="ä»£ä¸ºå¡«å†™">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon btn-remind" onclick="remindVillager('å¼ ä¸‰')" title="å‘é€æé†’">
                                <i class="fas fa-bell"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="villager-item">
                        <div class="villager-info">
                            <h4>æå››</h4>
                            <p>èº«ä»½è¯ï¼š320***********5678</p>
                        </div>
                        <div class="villager-actions">
                            <button class="btn-icon btn-call" onclick="callVillager('æå››')" title="ç”µè¯è”ç³»">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="btn-icon btn-edit" onclick="fillForVillager('æå››')" title="ä»£ä¸ºå¡«å†™">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon btn-remind" onclick="remindVillager('æå››')" title="å‘é€æé†’">
                                <i class="fas fa-bell"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="completedList" class="villager-list" style="display: none;">
                    <div class="villager-item">
                        <div class="villager-info">
                            <h4>ç‹äº”</h4>
                            <p>å®Œæˆæ—¶é—´ï¼š2024-03-05 14:30</p>
                        </div>
                        <div class="villager-actions">
                            <button class="btn-icon btn-secondary" onclick="viewSubmission('ç‹äº”')" title="æŸ¥çœ‹æäº¤">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div style="margin-top: 24px;">
                    <button class="btn btn-primary" onclick="sendBatchReminder()">
                        <i class="fas fa-paper-plane"></i> æ‰¹é‡å‘é€æé†’
                    </button>
                    <button class="btn btn-secondary" onclick="exportData()">
                        <i class="fas fa-download"></i> å¯¼å‡ºExcel
                    </button>
                </div>
            </div>
        </div>

        <!-- æ‘æ°‘å¡«æŠ¥é¡µé¢ -->
        <div id="villagerForm" class="screen">
            <div class="form-section">
                <div class="form-card">
                    <h3 class="form-title">å­£åº¦ä½ä¿æˆ·ç»Ÿè®¡è¡¨</h3>
                    <p style="color: #666; margin-bottom: 20px;">è¯·ç¡®è®¤æˆ–è¡¥å……ä»¥ä¸‹ä¿¡æ¯</p>
                    
                    <div class="form-group">
                        <label class="form-label">å§“å</label>
                        <input type="text" class="form-input prefilled" value="å¼ ä¸‰" readonly>
                        <div class="prefilled-label">âœ“ ç³»ç»Ÿé¢„å¡« (99%ç½®ä¿¡åº¦)</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">èº«ä»½è¯å·ç </label>
                        <input type="text" class="form-input prefilled" value="320***********1234" readonly>
                        <div class="prefilled-label">âœ“ ç³»ç»Ÿé¢„å¡« (99%ç½®ä¿¡åº¦)</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">è”ç³»æ–¹å¼</label>
                        <input type="text" class="form-input prefilled" value="138****5678">
                        <div class="prefilled-label">âœ“ ç³»ç»Ÿé¢„å¡« (95%ç½®ä¿¡åº¦)</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">å®¶åº­æœˆæ”¶å…¥ (å…ƒ)</label>
                        <input type="number" class="form-input" placeholder="è¯·è¾“å…¥å®¶åº­æœˆæ”¶å…¥">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ç°ä½å€</label>
                        <input type="text" class="form-input" placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">å¤‡æ³¨</label>
                        <textarea class="form-input" rows="3" placeholder="å…¶ä»–éœ€è¦è¯´æ˜çš„æƒ…å†µ"></textarea>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="submitForm()">
                    <i class="fas fa-check"></i> æäº¤ä¿¡æ¯
                </button>
            </div>
        </div>

        <!-- æ•°æ®ç®¡ç†é¡µé¢ -->
        <div id="dataManagement" class="screen">
            <div class="form-section">
                <div class="form-card">
                    <h3 class="form-title">æ‘å¤§è¡¨æ•°æ®ç»´æŠ¤</h3>
                    
                    <div class="form-group">
                        <label class="form-label">æœç´¢æ‘æ°‘</label>
                        <input type="text" class="form-input" placeholder="è¾“å…¥å§“åæˆ–èº«ä»½è¯å·" oninput="searchVillager(this.value)">
                    </div>
                </div>
                
                <div id="villagerDataList" class="villager-list">
                    <div class="villager-item" onclick="editVillagerData('å¼ ä¸‰')">
                        <div class="villager-info">
                            <h4>å¼ ä¸‰</h4>
                            <p>èº«ä»½è¯ï¼š320***********1234 | ç”µè¯ï¼š138****5678</p>
                        </div>
                        <div class="villager-actions">
                            <button class="btn-icon btn-edit" title="ç¼–è¾‘ä¿¡æ¯">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="villager-item" onclick="editVillagerData('æå››')">
                        <div class="villager-info">
                            <h4>æå››</h4>
                            <p>èº«ä»½è¯ï¼š320***********5678 | ç”µè¯ï¼š139****1234</p>
                        </div>
                        <div class="villager-actions">
                            <button class="btn-icon btn-edit" title="ç¼–è¾‘ä¿¡æ¯">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentScreen = 'roleSelection';
        let currentRole = null;

        // è§’è‰²é€‰æ‹©
        function selectRole(role) {
            currentRole = role;
            if (role === 'village-committee') {
                showScreen('committeeDashboard');
                updateHeader('æ‘ä¸¤å§”å·¥ä½œå°', 'æ•°æ®é‡‡é›†ä¸ç®¡ç†');
            } else if (role === 'villager') {
                showScreen('villagerForm');
                updateHeader('ä¿¡æ¯å¡«æŠ¥', 'è¯·ç¡®è®¤æˆ–è¡¥å……ä¿¡æ¯');
            }
        }

        // é¡µé¢åˆ‡æ¢
        function showScreen(screenId) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            document.getElementById(screenId).classList.add('active');
            currentScreen = screenId;
            
            // æ›´æ–°å¤´éƒ¨
            updateScreenHeader(screenId);
            
            // æ˜¾ç¤ºè¿”å›æŒ‰é’®
            if (screenId !== 'roleSelection') {
                document.querySelector('.back-btn').style.display = 'block';
            } else {
                document.querySelector('.back-btn').style.display = 'none';
            }
        }

        // æ›´æ–°é¡µé¢å¤´éƒ¨
        function updateScreenHeader(screenId) {
            const headers = {
                'roleSelection': { title: 'å–„æ²»ç¾', subtitle: 'æ•°å­—åŒ–æ‘åŠ¡ç®¡ç†ç³»ç»Ÿ' },
                'committeeDashboard': { title: 'æ‘ä¸¤å§”å·¥ä½œå°', subtitle: 'æ•°æ®é‡‡é›†ä¸ç®¡ç†' },
                'fileUpload': { title: 'æ–°å»ºä»»åŠ¡', subtitle: 'ä¸Šä¼ è¡¨æ ¼æ–‡ä»¶' },
                'templateLibrary': { title: 'è¡¨æ ¼æ¨¡æ¿åº“', subtitle: 'é€‰æ‹©æˆ–åˆ›å»ºæ¨¡æ¿' },
                'taskBoard': { title: 'ä»»åŠ¡çœ‹æ¿', subtitle: 'æ•°æ®é‡‡é›†è¿›åº¦ç®¡ç†' },
                'villagerForm': { title: 'ä¿¡æ¯å¡«æŠ¥', subtitle: 'è¯·ç¡®è®¤æˆ–è¡¥å……ä¿¡æ¯' },
                'dataManagement': { title: 'æ‘å¤§è¡¨ç®¡ç†', subtitle: 'æ•°æ®ç»´æŠ¤ä¸æ›´æ–°' }
            };
            
            const header = headers[screenId];
            if (header) {
                updateHeader(header.title, header.subtitle);
            }
        }

        // æ›´æ–°å¤´éƒ¨ä¿¡æ¯
        function updateHeader(title, subtitle) {
            document.getElementById('headerTitle').textContent = title;
            document.getElementById('headerSubtitle').textContent = subtitle;
        }

        // è¿”å›ä¸Šä¸€é¡µ
        function goBack() {
            if (currentScreen === 'committeeDashboard' || currentScreen === 'villagerForm') {
                showScreen('roleSelection');
            } else if (currentRole === 'village-committee') {
                showScreen('committeeDashboard');
            } else {
                showScreen('roleSelection');
            }
        }

        // æ–‡ä»¶ä¸Šä¼ å¤„ç†
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // æ¨¡æ‹Ÿæ–‡ä»¶å¤„ç†
                showProcessingDialog('æ­£åœ¨å¤„ç†æ–‡ä»¶...', () => {
                    showOCRResult(file.name);
                });
            }
        }

        // OCRè¯†åˆ«
        function startOCR() {
            showProcessingDialog('å¯åŠ¨ç›¸æœºè¿›è¡ŒOCRè¯†åˆ«...', () => {
                showOCRResult('æ‹ç…§è¯†åˆ«ç»“æœ');
            });
        }

        // æ˜¾ç¤ºå¤„ç†å¯¹è¯æ¡†
        function showProcessingDialog(message, callback) {
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;
            
            dialog.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 12px; text-align: center; max-width: 300px;">
                    <div class="loading" style="margin: 0 auto 16px;"></div>
                    <p>${message}</p>
                </div>
            `;
            
            document.body.appendChild(dialog);
            
            setTimeout(() => {
                document.body.removeChild(dialog);
                callback();
            }, 2000);
        }

        // æ˜¾ç¤ºOCRè¯†åˆ«ç»“æœ
        function showOCRResult(fileName) {
            alert(`æ–‡ä»¶ "${fileName}" å¤„ç†å®Œæˆï¼\n\nè¯†åˆ«åˆ°è¡¨æ ¼å­—æ®µï¼š\n- å§“å\n- èº«ä»½è¯å·ç \n- è”ç³»æ–¹å¼\n- å®¶åº­æ”¶å…¥\n\nç³»ç»Ÿå·²è‡ªåŠ¨åŒ¹é…æ‘å¤§è¡¨æ•°æ®ï¼Œç½®ä¿¡åº¦95%ã€‚\n\næ˜¯å¦ä¿å­˜ä¸ºæ¨¡æ¿ï¼Ÿ`);
            showScreen('taskBoard');
        }

        // ä½¿ç”¨æ¨¡æ¿
        function useTemplate(templateId) {
            showProcessingDialog('æ­£åœ¨åŠ è½½æ¨¡æ¿...', () => {
                alert('æ¨¡æ¿åŠ è½½æˆåŠŸï¼å·²è‡ªåŠ¨é¢„å¡«å……æ‘æ°‘æ•°æ®ã€‚');
                showScreen('taskBoard');
            });
        }

        // åˆ›å»ºæ–°æ¨¡æ¿
        function createNewTemplate() {
            alert('è¿›å…¥å¯è§†åŒ–æ¨¡æ¿ç¼–è¾‘å™¨...\n\næ‚¨å¯ä»¥é€šè¿‡æ‹–æ‹½ç»„ä»¶æ¥åˆ›å»ºè‡ªå®šä¹‰è¡¨æ ¼æ¨¡æ¿ã€‚');
        }

        // ä»»åŠ¡çœ‹æ¿æ ‡ç­¾åˆ‡æ¢
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if (tab === 'pending') {
                document.getElementById('pendingList').style.display = 'block';
                document.getElementById('completedList').style.display = 'none';
            } else {
                document.getElementById('pendingList').style.display = 'none';
                document.getElementById('completedList').style.display = 'block';
            }
        }

        // æ‘æ°‘æ“ä½œåŠŸèƒ½
        function callVillager(name) {
            alert(`æ­£åœ¨æ‹¨æ‰“ ${name} çš„ç”µè¯...`);
        }

        function fillForVillager(name) {
            alert(`ä¸º ${name} ä»£å¡«ä¿¡æ¯...\n\nç³»ç»Ÿå·²é¢„å¡«å……å·²çŸ¥æ•°æ®ï¼Œè¯·è¡¥å……ç¼ºå¤±ä¿¡æ¯ã€‚`);
        }

        function remindVillager(name) {
            alert(`å·²å‘ ${name} å‘é€å¡«æŠ¥æé†’ï¼`);
        }

        function viewSubmission(name) {
            alert(`æŸ¥çœ‹ ${name} çš„æäº¤ä¿¡æ¯...`);
        }

        // æ‰¹é‡æ“ä½œ
        function sendBatchReminder() {
            alert('å·²å‘35ä½æœªå®Œæˆå¡«æŠ¥çš„æ‘æ°‘å‘é€æé†’ï¼');
        }

        function exportData() {
            showProcessingDialog('æ­£åœ¨ç”ŸæˆExcelæ–‡ä»¶...', () => {
                alert('Excelæ–‡ä»¶ç”ŸæˆæˆåŠŸï¼\n\næ–‡ä»¶å·²ä¿å­˜åˆ°æœ¬åœ°ï¼Œå¯é€šè¿‡å¾®ä¿¡ç­‰æ–¹å¼æäº¤ç»™ä¸Šçº§éƒ¨é—¨ã€‚');
            });
        }

        // è¡¨å•æäº¤
        function submitForm() {
            showProcessingDialog('æ­£åœ¨æäº¤ä¿¡æ¯...', () => {
                alert('ä¿¡æ¯æäº¤æˆåŠŸï¼\n\næ„Ÿè°¢æ‚¨çš„é…åˆã€‚');
                showScreen('roleSelection');
            });
        }

        // æ•°æ®ç®¡ç†
        function searchVillager(query) {
            // æ¨¡æ‹Ÿæœç´¢åŠŸèƒ½
            console.log('æœç´¢æ‘æ°‘:', query);
        }

        function editVillagerData(name) {
            alert(`ç¼–è¾‘ ${name} çš„è¯¦ç»†ä¿¡æ¯...\n\næ‚¨å¯ä»¥ä¿®æ”¹ä»»ä½•å­—æ®µï¼Œç³»ç»Ÿä¼šè®°å½•å˜æ›´å†å²ã€‚`);
        }

        // æ‹–æ‹½ä¸Šä¼ 
        const uploadArea = document.querySelector('.upload-area');
        if (uploadArea) {
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload({ target: { files } });
                }
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('å–„æ²»ç¾ç³»ç»Ÿå·²åŠ è½½');
        });
    </script>
</body>
</html>